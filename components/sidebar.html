<div class="flex flex-col w-64 bg-white h-screen border-r border-slate-200 sticky top-0 overflow-y-auto z-50">
    <div class="p-6">
        <h1 class="text-xl font-bold text-[#5c56f1] flex items-center gap-2">
            <span class="w-8 h-8 bg-[#5c56f1] rounded-lg flex items-center justify-center text-white text-xs">S</span>
            Sale Support
        </h1>
    </div>

    <nav class="flex-1 px-4 space-y-1">
        <p class="px-4 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2 mt-4">Main Menu</p>
        
        <a href="dashboard.html" class="flex items-center gap-3 p-3.5 text-slate-600 hover:bg-indigo-50 hover:text-[#5c56f1] rounded-2xl transition group">
            <span class="text-lg">üè†</span> <span class="font-medium">Dashboard</span>
        </a>

        <a href="new-ticket.html" class="flex items-center gap-3 p-3.5 text-slate-600 hover:bg-indigo-50 hover:text-[#5c56f1] rounded-2xl transition">
            <span class="text-lg">‚ûï</span> <span class="font-medium">‡∏™‡∏£‡πâ‡∏≤‡∏á Ticket</span>
        </a>

        <a href="my-ticket.html" class="flex items-center gap-3 p-3.5 text-slate-600 hover:bg-indigo-50 hover:text-[#5c56f1] rounded-2xl transition">
            <span class="text-lg">üìã</span> <span class="font-medium">‡πÉ‡∏ö‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</span>
        </a>

        <a href="all-ticket.html" class="flex items-center gap-3 p-3.5 text-slate-600 hover:bg-indigo-50 hover:text-[#5c56f1] rounded-2xl transition">
            <span class="text-lg">üé´</span> <span class="font-medium">‡πÉ‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
        </a>

        <a href="profile.html" class="flex items-center gap-3 p-3.5 text-slate-600 hover:bg-indigo-50 hover:text-[#5c56f1] rounded-2xl transition">
            <span class="text-lg">üë§</span> <span class="font-medium">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</span>
        </a>

        <div id="admin-menu-section" class="hidden pt-6 border-t border-slate-100 mt-4">
            <p class="px-4 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2">Admin Control</p>
            
            <a href="manage-tickets.html" class="flex items-center gap-3 p-3.5 text-slate-600 hover:bg-indigo-50 hover:text-[#5c56f1] rounded-2xl transition">
                <span class="text-lg">üõ†Ô∏è</span> <span class="font-medium">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Ticket (System)</span>
            </a>
            <a href="user-management.html" class="flex items-center gap-3 p-3.5 text-slate-600 hover:bg-indigo-50 hover:text-[#5c56f1] rounded-2xl transition">
                <span class="text-lg">üë•</span> <span class="font-medium">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
            </a>
            <a href="settings.html" class="flex items-center gap-3 p-3.5 text-slate-600 hover:bg-indigo-50 hover:text-[#5c56f1] rounded-2xl transition">
                <span class="text-lg">‚öôÔ∏è</span> <span class="font-medium">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤</span>
            </a>
        </div>
    </nav>

    <div class="p-4 border-t border-slate-100">
        <button id="main-logout-btn" class="w-full flex items-center gap-3 p-4 text-red-500 hover:bg-red-50 rounded-2xl transition font-bold">
            <span class="text-lg">üö™</span> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
        </button>
    </div>
</div>

<script type="module">
    // ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏≤‡∏Å Firebase
    import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const auth = getAuth();
    const db = getFirestore();

    // --- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤ LOGOUT ---
    // ‡πÉ‡∏ä‡πâ addEventListener ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô 100% ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏∂‡πà‡∏á onclick ‡πÉ‡∏ô HTML
    const btnLogout = document.getElementById('main-logout-btn');
    if (btnLogout) {
        btnLogout.addEventListener('click', async () => {
            if (confirm("‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
                try {
                    await signOut(auth);
                    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Logout ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ login.html ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                    window.location.replace("login.html"); 
                } catch (error) {
                    console.error("Logout Error:", error);
                    alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö");
                }
            }
        });
    }

    // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (Role Check) ---
    onAuthStateChanged(auth, async (user) => {
        if (user) {
            try {
                // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Role ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡∏Å‡∏ä‡∏±‡∏ô admin
                const userDoc = await getDoc(doc(db, "admin", user.uid));
                if (userDoc.exists()) {
                    const userData = userDoc.data();
                    // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏ô‡∏π Admin ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ role ‡πÄ‡∏õ‡πá‡∏ô 'admin'
                    if (userData.role === 'admin') {
                        const adminSection = document.getElementById('admin-menu-section');
                        if (adminSection) adminSection.classList.remove('hidden');
                    }
                }
            } catch (err) {
                console.error("Role Check Error:", err);
            }
        } else {
            // ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Login ‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πâ‡∏á‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Login ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Security Check)
            if (!window.location.href.includes("login.html")) {
                window.location.replace("login.html");
            }
        }
    });
</script>
